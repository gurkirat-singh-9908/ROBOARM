{% extends "base.html" %}

{% block title %}Robotic Arm - Manual Control{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
{% endblock %}

{% block content %}
<div class="row">
  <!-- Left Column: Explanation and Controls -->
  <div class="col-md-6">
    <h2 class="mb-3">Manual Control</h2>
    <p class="mb-3">
      Control the robotic arm using positional sliders, orientation knobs, and gripper control.
    </p>
    
    <!-- Positional Control (Sliders) -->
    <div class="control-box mb-3">
      <h5 class="mb-2">Positional Control</h5>
      <div class="mb-2">
        <label for="slider_x" class="control-label">X</label>
        <input type="range" class="form-range" id="slider_x" min="-0.8" max="0.8" step="0.01" value="0">
        <div class="d-flex justify-content-between">
          <span>-0.8</span>
          <span id="value_x">0</span>
          <span>0.8</span>
        </div>
      </div>
      <div class="mb-2">
        <label for="slider_y" class="control-label">Y</label>
        <input type="range" class="form-range" id="slider_y" min="-0.8" max="0.8" step="0.01" value="0">
        <div class="d-flex justify-content-between">
          <span>-0.8</span>
          <span id="value_y">0</span>
          <span>0.8</span>
        </div>
      </div>
      <div class="mb-2">
        <label for="slider_z" class="control-label">Z</label>
        <input type="range" class="form-range" id="slider_z" min="-0.8" max="0.8" step="0.01" value="0">
        <div class="d-flex justify-content-between">
          <span>-0.8</span>
          <span id="value_z">0</span>
          <span>0.8</span>
        </div>
      </div>
    </div>
    
    <!-- Orientation Control (Knobs) -->
    <div class="control-box">
      <h5 class="mb-2">Orientation Control</h5>
      <div class="row">
        <!-- Roll Knob -->
        <div class="col-4">
          <div class="knob-container" data-param="roll">
            <div class="ring"></div>
            <div class="ring-fill"></div>
            <div class="space"></div>
            <div class="knob">
              <div class="knob-indicator-container">
                <div class="knob-indicator"></div>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-between">
            <span>0</span>
            <span id="value_roll">0</span>
            <span>180</span>
          </div>
          <div class="dial-label">Roll</div>
        </div>
        <!-- Pitch Knob -->
        <div class="col-4">
          <div class="knob-container" data-param="pitch">
            <div class="ring"></div>
            <div class="ring-fill"></div>
            <div class="space"></div>
            <div class="knob">
              <div class="knob-indicator-container">
                <div class="knob-indicator"></div>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-between">
            <span>0</span>
            <span id="value_pitch">0</span>
            <span>180</span>
          </div>
          <div class="dial-label">Pitch</div>
        </div>
        <!-- Yaw Knob -->
        <div class="col-4">
          <div class="knob-container" data-param="yaw">
            <div class="ring"></div>
            <div class="ring-fill"></div>
            <div class="space"></div>
            <div class="knob">
              <div class="knob-indicator-container">
                <div class="knob-indicator"></div>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-between">
            <span>0</span>
            <span id="value_yaw">0</span>
            <span>180</span>
          </div>
          <div class="dial-label">Yaw</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Right Column: Robotic Arm Image and Controls -->
  <div class="col-md-6">
    <div class="img-container mb-3">
      <img src="{{ url_for('static', filename='robo.jpeg') }}" alt="Robotic Arm" class="img-fluid">
    </div>
    
    <!-- Preset Positions -->
    <div class="control-box mb-3">
      <h5 class="mb-2">Preset Positions</h5>
      <div class="row">
        <div class="col-6">
          <button id="home_position" class="btn btn-primary w-100">
            <i class="bi bi-house-door-fill me-2"></i>Home
          </button>
        </div>
        <div class="col-6">
          <button id="rest_position" class="btn btn-primary w-100">
            <i class="bi bi-pause-circle-fill me-2"></i>Rest
          </button>
        </div>
      </div>
    </div>
    
    <!-- Gripper Control (Moved to right column) -->
    <div class="control-box mb-3">
      <h5 class="mb-2">Gripper Control</h5>
      <div class="mb-2">
        <label for="slider_gripper" class="control-label">Gripper Opening</label>
        <input type="range" class="form-range" id="slider_gripper" min="0" max="100" step="1" value="0">
        <div class="d-flex justify-content-between">
          <span>Closed (0%)</span>
          <span id="value_gripper">0</span>
          <span>Open (100%)</span>
        </div>
      </div>
    </div>
    
    <div class="position-display">
      <h5 class="mb-2">Current Position</h5>
      <div class="row">
        <div class="col-md-6">
          <p class="mb-1"><strong>X:</strong> <span id="display_x">0</span></p>
          <p class="mb-1"><strong>Y:</strong> <span id="display_y">0</span></p>
          <p class="mb-1"><strong>Z:</strong> <span id="display_z">0</span></p>
          <p class="mb-1"><strong>Gripper:</strong> <span id="display_gripper">0</span>%</p>
        </div>
        <div class="col-md-6">
          <p class="mb-1"><strong>Roll:</strong> <span id="display_roll">0</span>°</p>
          <p class="mb-1"><strong>Pitch:</strong> <span id="display_pitch">0</span>°</p>
          <p class="mb-1"><strong>Yaw:</strong> <span id="display_yaw">0</span>°</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.5.4/dist/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='js/manual_control.js') }}"></script>
{% endblock %}
